## clip-path：实现形态及区域变化等高级动画效果

上一个章节讲了 `clip-path` 的基本功能和用法，并且围绕它的静态效果进行描述。本章节将围绕它的动画效果进行讲解，探索它能实现什么样的动画。

### 基于 clip-path 的形变动画

`clip-path` 可以搭配 `transition` 和 `animation` 实现各种动画变化，因此借助过渡和动画效果可以实现一些形变的动画效果。比如，下面这个例子：

::: code-group

```html
<div class="box"></div>
```

```css
.box {
  width: 100px;
  height: 100px;
  background: #f00;
  animation: polygon-change 3s linear infinite;
}

@keyframes polygon-change {
  5% {
    clip-path: polygon(50% 0%, 0% 100%, 0% 100%, 100% 100%, 100% 100%);
  }
  35% {
    clip-path: polygon(50% 0%, 0% 50%, 50% 100%, 100% 50%, 100% 50%);
  }
  65% {
    clip-path: polygon(50% 0%, 0% 38%, 18% 100%, 82% 100%, 100% 38%);
  }
  100% {
    clip-path: polygon(50% 0%, 0% 100%, 0% 100%, 100% 100%, 100% 100%);
  }
}
```

:::

细心看代码可以看出，上面的代码 `polygon()` 无论是三边形还是四边形，都用了五个顶点，这是为什么呢？如果用对应个数的顶点，会发生什么事情呢？修改一下代码查看效果。

::: code-group

```html
<div class="box-nomore"></div>
```

```css
.box-nomre {
  width: 100px;
  height: 100px;
  background: pink;
  animation: polygon-change-nomore 3s linear infinite;
}

@keyframes polygon-change {
  5% {
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  }
  35% {
    clip-path: polygon(50% 0%, 0% 50%, 50% 100%, 100% 50%);
  }
  65% {
    clip-path: polygon(50% 0%, 0% 38%, 18% 100%, 82% 100%, 100% 38%);
  }
  100% {
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  }
}
```

:::

> 具体效果可查看 [clip-path 形变动画](https://codepen.io/duyidao/pen/PwZEMEx)

可以看到，当 `polygon()` 的顶点个数不一致时，它就会变成逐帧动画，而不是带有过渡的补间动画。

> [!info] 补充
> **逐帧动画**就是每一帧都是关键帧：每一帧都是自己做出来的。**补间动画**就是知道两端的关键帧，通过计算机自己能计算出中间帧的动画。

### clip-path 的缺陷

从上面的例子可以看出，`clip-path` 在做动画时的缺陷，当进行动画或者过渡的两个 `clip-path` 的顶点个数不一致时，动画会变成逐帧动画，而不是补间动画。

因此需要一点小巧思，让多出来的顶点的坐标个其他点的坐标重合，从而达到隐藏多余的顶点，让数量保持一致。还是以上面的示例为例子，一图流展示：

![一图流展示](https://pic1.imgdb.cn/item/68f5cdb83203f7be0080e547.png)

### 基于 clip-path 的图形变换动画

`clip-path` 除了可以用于实现形变动画，还可以用于实现图形变换动画，比如下面这个效果：

![图形变换动画](https://pic1.imgdb.cn/item/68f5ce283203f7be0080e944.gif)

咋一看好像很复杂，其实拆分下来都是前面学过做过的，具体实现如下：

- 父级 `div` 从正方形过渡到矩形：

  ![父级效果](https://pic1.imgdb.cn/item/68f5d18a3203f7be0080f3fc.gif)

- 子级分为四个部分，每个部分都有自己的过渡动画，以其中一个三角形为例：

  ![子级效果](https://pic1.imgdb.cn/item/68f5d2f83203f7be0080f90b.gif)

  只需要依次实现四个三角形的过渡动画即可。

::: code-group

```html
<div class="box">
  <div class="box1"></div>
  <div class="box2"></div>
  <div class="box3"></div>
  <div class="box4"></div>
</div>
```

```css
.box {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 10px auto;
  animation: change 2s infinite alternate;
}

.box1,
.box2,
.box3,
.box4 {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.box1 {
  animation: clip-box1 2s infinite alternate;
}

.box2 {
  animation: clip-box2 2s infinite alternate;
}

.box3 {
  animation: clip-box3 2s infinite alternate;
}

.box4 {
  animation: clip-box4 2s infinite alternate;
}

@keyframes clip-box1 {
  0% {
    background-color: #333;
    clip-path: polygon(0% 0%, 50% 50%, 0% 100%);
  }
  100% {
    background-color: skyblue;
    clip-path: polygon(0% 100%, 12.5% 0%, 25% 100%);
  }
}

@keyframes clip-box2 {
  0% {
    background-color: #333;
    clip-path: polygon(0% 0%, 50% 50%, 100% 0%);
  }
  100% {
    background-color: skyblue;
    clip-path: polygon(25% 0%, 37.5% 100%, 50% 0%);
  }
}

@keyframes clip-box3 {
  0% {
    background-color: #333;
    clip-path: polygon(100% 0%, 50% 50%, 100% 100%);
  }
  100% {
    background-color: skyblue;
    clip-path: polygon(75% 0%, 87.5% 100%, 100% 0%);
  }
}

@keyframes clip-box4 {
  0% {
    background-color: #333;
    clip-path: polygon(0% 100%, 50% 50%, 100% 100%);
  }
  100% {
    background-color: skyblue;
    clip-path: polygon(50% 100%, 62.5% 0%, 75% 100%);
  }
}

@keyframes change {
  0% {
    width: 100px;
    height: 100px;
  }
  100% {
    width: 200px;
    height: 50px;
  }
}
```

:::

> 具体效果可查看 [clip-path 图形变换动画](https://codepen.io/duyidao/pen/EaPQxKM)

### 基于 clip-path 的边框动画

上面基于 `clip-path` 实现动画效果，都是围绕着修改坐标点进行的，通过从一个形状裁剪成另外一个形状来实现。下面继续利用这个特点，实现边框动画效果。

![边框动画效果](https://pic1.imgdb.cn/item/68f5e2bb3203f7be00814a5c.gif)

咋一看好像很复杂，其实可以利用 `clip-path: inset()` 方法来实现，`inset()` 方法主要用于定义一个矩形的内凹形状，具体语法如下：

```css
clip-path: inset(10px 20px 30px 40px);
```

上面代码表示，矩形从上、右、下、左四个方向分别内凹 10px、20px、30px、40px，具体效果如下：

应用到这个例子中，只需要为 `div` 的伪类 `::before` 设置 `inset()` ，通过动画修改其参数让它在内部裁剪出靠上、靠左、靠下、靠右的矩形，添加上边框即可。

::: code-group

```html
<div class="box"></div>
<div class="bg">示意图</div>
```

```css
body,
html {
  width: 100%;
  height: 100%;
  display: flex;
}

div {
  position: relative;
  margin: auto;
  width: 160px;
  line-height: 160px;
  text-align: center;
  font-size: 24px;
  background: skyblue;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 4px solid red;
    transition: all 0.5s;
    animation: clippath 3s infinite linear;
  }
}

@keyframes clippath {
  0%,
  100% {
    clip-path: inset(0 0 50% 0);
  }

  25% {
    clip-path: inset(0 50% 0 0);
  }
  50% {
    clip-path: inset(50% 0 0 0);
  }
  75% {
    clip-path: inset(0 0 0 50%);
  }
}

.bg::before {
  background: rgba(255, 215, 0, 0.5);
}
```

:::

> 具体效果可查看 [clip-path 边框动画](https://codepen.io/duyidao/pen/ZYQrGOK)
